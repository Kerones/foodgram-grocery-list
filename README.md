<h1 align="center"> –ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –ø–æ–º–æ—â–Ω–∏–∫ <a href="http://food-gramm.sytes.net/" target="_blank">Foodgram</a></h1>

<a href="http://food-gramm.sytes.net/" target="_blank">Foodgram</a>, ¬´–ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –ø–æ–º–æ—â–Ω–∏–∫¬ª. –ù–∞ —ç—Ç–æ–º —Å–µ—Ä–≤–∏—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç—ã, –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è —Ä–µ—Ü–µ–ø—Ç—ã –≤ —Å–ø–∏—Å–æ–∫ ¬´–ò–∑–±—Ä–∞–Ω–Ω–æ–µ¬ª, –∞ –ø–µ—Ä–µ–¥ –ø–æ—Ö–æ–¥–æ–º –≤ –º–∞–≥–∞–∑–∏–Ω —Å–∫–∞—á–∞—Ç—å —Å–≤–æ–¥–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –±–ª—é–¥.

[![Python](https://img.shields.io/badge/-Python-464646?style=flat-square&logo=Python)](https://www.python.org/)
[![Django](https://img.shields.io/badge/-Django-464646?style=flat-square&logo=Django)](https://www.djangoproject.com/)
[![Django REST Framework](https://img.shields.io/badge/-Django%20REST%20Framework-464646?style=flat-square&logo=Django%20REST%20Framework)](http://food-gramm.sytes.net/api/docs/)
[![PostgreSQL](https://img.shields.io/badge/-PostgreSQL-464646?style=flat-square&logo=PostgreSQL)](https://www.postgresql.org/)
[![Nginx](https://img.shields.io/badge/-NGINX-464646?style=flat-square&logo=NGINX)](https://nginx.org/ru/)
[![gunicorn](https://img.shields.io/badge/-gunicorn-464646?style=flat-square&logo=gunicorn)](https://gunicorn.org/)
[![docker](https://img.shields.io/badge/-Docker-464646?style=flat-square&logo=docker)](https://www.docker.com/)
[![GitHub%20Actions](https://img.shields.io/badge/-GitHub%20Actions-464646?style=flat-square&logo=GitHub%20actions)](https://github.com/features/actions)
[![Yandex.Cloud](https://img.shields.io/badge/-Yandex.Cloud-464646?style=flat-square&logo=Yandex.Cloud)](https://cloud.yandex.ru/)

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞
### –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É:
```
git clone https://github.com/Kerones/foodgram-project-react
```
## –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —É–¥–∞–ª–µ–Ω–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–ºüíª (–Ω–∞ ubuntu):
* –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Ö–æ–¥ –Ω–∞ —Å–≤–æ–π —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ docker –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
```
sudo apt install docker.io 
```
* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ docker-compose –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
```
sudo curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker compose
```
* –õ–æ–∫–∞–ª—å–Ω–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª infra/nginx.conf, –≤–ø–∏—Å–∞–≤ –≤ —Å—Ç—Ä–æ–∫—É server_name —Å–≤–æ–π IP
* –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã docker-compose.production.yml –∏ nginx.conf –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ infra –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
```
scp docker-compose.yml <username>@<host>:/home/<username>/docker-compose.yml
scp nginx.conf <username>@<host>:/home/<username>/nginx.conf
```

* C–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª –∏ –≤–ø–∏—à–∏—Ç–µ <img src="https://github.com/goforbg/telegram-emoji-gifs/blob/master/pencil-writing.gif" height="20"/>:
    ```
    DB_ENGINE=<django.db.backends.postgresql>
    DB_NAME=<–∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö postgres>
    DB_USER=<–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–¥>
    DB_PASSWORD=<–ø–∞—Ä–æ–ª—å>
    DB_HOST=<db>
    DB_PORT=<5432>
    SECRET_KEY=<—Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –ø—Ä–æ–µ–∫—Ç–∞ django>
    ```
* –î–ª—è —Ä–∞–±–æ—Ç—ã —Å Workflow –¥–æ–±–∞–≤—å—Ç–µ –≤ Secrets GitHub –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã:
    ```
    DB_ENGINE=<django.db.backends.postgresql>
    DB_NAME=<–∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö postgres>
    DB_USER=<–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–¥>
    DB_PASSWORD=<–ø–∞—Ä–æ–ª—å>
    DB_HOST=<db>
    DB_PORT=<5432>
    
    DOCKER_PASSWORD=<–ø–∞—Ä–æ–ª—å –æ—Ç DockerHub>
    DOCKER_USERNAME=<–∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è>
    
    SECRET_KEY=<—Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –ø—Ä–æ–µ–∫—Ç–∞ django>

    USER=<username –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É>
    HOST=<IP —Å–µ—Ä–≤–µ—Ä–∞>
    PASSPHRASE=<–ø–∞—Ä–æ–ª—å –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞, –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω>
    SSH_KEY=<–≤–∞—à SSH –∫–ª—é—á (–¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–∞: cat ~/.ssh/id_rsa)>

    ```
    Workflow —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä—ë—Ö —à–∞–≥–æ–≤:
     - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ PEP8
     - –°–±–æ—Ä–∫–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–∞ –±–µ–∫–µ–Ω–¥–∞ –Ω–∞ DockerHub.
     - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.
  
* –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–æ–±–µ—Ä–∏—Ç–µ docker-compose:
```
sudo docker compose -f docker-compose.production.yml up -d --build
```
* –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã (—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –¥–µ–ø–ª–æ—è):
    - –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
    ```
    sudo docker compose exec backend python manage.py makemigrations
    sudo docker compose exec backend python manage.py migrate
    ```
    - –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –∏–Ω–≥—Ä–∏–¥–µ–Ω—Ç—ã –∏ —Ç–µ–≥–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):  
    ```
    sudo docker compose -f docker-compose.production.yml exec backend python manage.py load_models --path 'api/data/ingredients.json'
    sudo docker compose -f docker-compose.production.yml exec backend python manage.py load_models --path 'api/data/tags.json'
    ```
    5. –°–æ–∑–¥–∞–π—Ç–µ django —Å—É–ø–µ—Ä—é–∑–µ—Ä–∞ –∏ —Å–æ–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏–∫—É:
    ```
    sudo docker compose -f docker-compose.production.yml exec backend python manage.py createsuperuser
    sudo docker compose -f docker-compose.production.yml exec backend python manage.py collectstatic --no-input
    ```
<h3 align="center"> üë®üèº‚Äçüíª–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª <a href="https://github.com/Kerones/" target="_blank">–í–∞—Å–∏–ª–∏–π –ì–∞–Ω—Ç–∏–º—É—Ä–æ–≤</a> —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å <a href="https://github.com/yandex-praktikum/"target="_blank">Yandex Practicum</a> <img src="https://yt3.googleusercontent.com/-pnsqu0xQYwxMhUVq-HZJHf691DEhTlEl1fZvjUtUwJIKMyTqXDBVvK7d2dSjFUTYdHFpTYvAo8=s900-c-k-c0x00ffffff-no-rj" height="18"/ </h3>
